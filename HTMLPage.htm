<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
        <title>Peterborough Fish and Game Association: Events</title>

   <style type="text/css">
        @import "js/dojotoolkit/dijit/themes/pfga/pfga.css";
    </style>
    
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="common.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        $.ajax({
            type: "GET",
            url: "events.xml",
            dataType: "xml",
            success: parseXml
        });
        
        function parseXml(xml) {
           
            $(xml).find("event").each(function() {

                //find each instance of header in xml file
                var description = $(this).find("description").text();
                
                //if blank hide row
                if (description == "") {
                    $("#eventGrid tbody tr").hide();
                } else {
                    //else add tr and td tags and add alt class for striping
                    $("#eventGrid tbody").append("<tr>" 
                        + "<td title='year' style='display:none;'>" + $(this).find("year").text() + "</td>"
                        + "<td title='month' style='display:none;'>" + $(this).find("month").text() + "</td>"
                        + "<td>" + $(this).find("date").text() + "</td>"
                        + "<td>" + $(this).find("description").text() + "</td>"
                        + "</tr><tr><td colspan='2' style='display:none;'></td>"
                        + "<td colspan='2'>" + $(this).find("time").text() + "</td>"
                        + "</tr>"
                     );
                }
            });
            
            var d = new Date();
            showMonth(d.getMonth() + 1);
            
            $('#monthInput').find('option[value=' + (d.getMonth() + 1) + ']').attr('selected','true');
            $('#monthInput').change(function () 
            { 
                showMonth($('#monthInput option:selected').val()); 
            
            });
        }
        
        function showMonth(selMonth)
        {
            var nYear;
            var nMonth;
            var d = new Date();
            
            $("#eventGrid tbody").find("tr").each(function() 
            {
                
                nYear = $(this).find('td[title="year"]').text();

                if (nYear < d.getFullYear() && nYear != '')
                {
                    $(this).hide();
                    $(this).next().hide();
                } else if (nYear >= d.getFullYear() && nYear != '')
                {
                    nMonth = $(this).find('td[title="month"]').text();
                    
                    if (nMonth != selMonth)
                    {
                        $(this).hide();
                        $(this).next().hide();
                    } else 
                    {
                        $(this).show();
                        $(this).next().show();
                    }
                }
            });
        }
    });
    
    
    </script>
</head>
<body class="pfga">
   <div id="header" class="pfga"></div>
   <div id="menu" class="pfga"></div>
   
   <div id="content" style="overflow:visible" class="pfga">
           
        <div class="Heading1" align="center" >Upcoming Range Events - PF&amp;GA</div>
        <p>
        <select id="monthInput" class="pfga">
            <option value='0'>Please select a month</option>
            <option value='1'>January</option>
            <option value='2'>February</option>
            <option value='3'>March</option>
            <option value='4'>April</option>
            <option value='5'>May</option>
            <option value='6'>June</option>
            <option value='7'>July</option>
            <option value='8'>August</option>
            <option value='9'>September</option>
            <option value='10'>October</option>
            <option value='11'>November</option>
            <option value='12'>December</option>
        </select>

            
        </p>
        <div style="overflow:scroll auto; height:500px;">
            <table class="pfgaTable" cellpadding="0px" cellspacing="0px" id="eventGrid">
              <thead>
                <tr>
                  <th style="display:none;">Year</th>
                  <th style="display:none;">Month</th>
                  <th width="80px" align="left">Date</th>
                  <th width="*%" align="left">Description</th>
                </tr>
                <tr>
                    <th align="left" colspan="2">Details</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
        </div>
        <div id="spacingDiv">This Div contains text that doesn't show up in the but rather is used as a space to size up the Div to it's maximum lengthThis Dic contains text that doesn't show up in the but rather is used as a space to size up the Div to it's maximum length</div>
   </div>     
   
   <div id="footer"></div>
   <input type="hidden" id="pageRef" value="#l_events" />
</body>
</html>

