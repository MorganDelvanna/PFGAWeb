<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="language" content="en-us" />
    <meta name="description" content="Peterborough Fish & Game Association gun club in Peterborough Ontario Canada" />
    <meta name="keywords" content="handgun, rifle, archery, indoor range, outdoor range" />
    <meta name="robots" content="all" />
    <meta name="author" content="Bryan McKellar" />
    <meta name="copyright" content="2018, PFGA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Peterborough Fish and Game Association: Events</title>

    <link rel="stylesheet" href="/css/pfga.css" />

    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel='stylesheet' href='/css/fullcalendar.css' />
    <link rel='stylesheet' href='/css/fullcalendar.print.css' media='print' />
    <link rel="stylesheet" href="css/pfga.css" />
    <link rel="shortcut icon" href="images/pfgalogo.ico" />

    <script src="js/jquery-3.2.1.min.js" type="text/javascript"></script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col center">
                <img alt="Peterborough Fish & Game Association" src="images/header.gif" />
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div id="menu">

                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div id='script-warning'>
                    <code>get-events.php</code> must be running.
                </div>
                <div id="test"></div>
                <div id='loading'>loading...</div>
                <div id='calendar'></div>
            </div>
        </div>
    </div>

    <div id="footer"></div>
    <input type="hidden" id="pageRef" value="#l_events" />
    <script src="/js/jquery.scrollabletable.js_2.js" type="text/javascript"></script>
    <script src="/js/common.js" type="text/javascript"></script>
    <script src='/js/moment.min.js'></script>
    <script src='/js/jquery-3.2.1.min.js'></script>
    <script src='/js/fullcalendar/index.global.min.js'></script>
    <script src="/js/popper.min.js"></script>
    <script src='/js/bootstrap.min.js'></script>
    <script src='https://unpkg.com/tooltip.js/dist/umd/tooltip.min.js'></script>
    <script>
        $(document).ready(function () {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: (function () { // Example using an IIFE for initial setup
                    if ($(window).width() <= 768) {
                        return 'listMonth';
                    } else {
                        return 'dayGridMonth';
                    }
                })(),
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: (function () {
                        if ($(window).width() <= 768) {
                            return 'listMonth';
                        } else {
                            return 'dayGridMonth,dayGridWeek,listMonth';
                        }
                    })() 
                },
                editable: true,
                eventStartEditable: false,
                events: 'calendar/events.php',
                eventDidMount: function (info) {
                    let calEvent = info.event;
                    let time                    
                    if (calEvent.allDay) {
                        time = 'All Day';
                    } else {
                        let dateStart = new Date(calEvent.startStr).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        let deteEnd = new Date(calEvent.endStr).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        time = dateStart + ' - ' + deteEnd;
                    }
                    var tooltipHtml = time + '<br />' + calEvent.title + '<br />' + calEvent.extendedProps.description;
                    let tooltip = new Tooltip(info.el, {
                        html: true,
                        title: tooltipHtml,
                        placement: 'bottom', // Adjust the placement as needed
                        trigger: 'hover', // Show the tooltip on hover
                        container: 'body',
                        sanitize: false,
                    });
                    // Check if it's a list view (optional, but good practice)
                    if (info.view.type.startsWith('list')) {
                        let parentWidth = $(info.el).parent().width();
                        
                        $(info.el).css('width', `${parentWidth}px`); // Set desired width
                        // You can also add conditions to set different widths based on event data
                        // if (event.someProperty === 'value') {
                        //   $(element).css('width', '250px');
                        // }
                    }
                },
                loading: function (bool) {
                    $('#loading').toggle(bool);
                }
            });
            calendar.render();
        });
    </script>
</body>
</html>